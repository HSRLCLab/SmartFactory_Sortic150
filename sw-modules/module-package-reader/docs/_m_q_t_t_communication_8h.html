<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MQTT Communication: MQTTCommunication.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MQTT Communication
   </div>
   <div id="projectbrief">Smart Factory</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_m_q_t_t_communication_8h.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">MQTTCommunication.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>The Connection-class is used as interface.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;Arduino.h&quot;</code><br />
<code>#include &quot;<a class="el" href="_communication_configuration_8h_source.html">CommunicationConfiguration.h</a>&quot;</code><br />
<code>#include &lt;CircularBuffer.h&gt;</code><br />
<code>#include &quot;<a class="el" href="_network_8h_source.html">Network/Network.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="my_j_s_o_n_8h_source.html">myJSON/myJSON.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="my_m_q_t_t_8h_source.html">myMQTT/myMQTT.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for MQTTCommunication.h:</div>
<div class="dyncontent">
<div class="center"><img src="_m_q_t_t_communication_8h__incl.png" border="0" usemap="#_m_q_t_t_communication_8h" alt=""/></div>
<map name="_m_q_t_t_communication_8h" id="_m_q_t_t_communication_8h">
<area shape="rect"  title="The Connection&#45;class is used as interface." alt="" coords="378,5,537,32"/>
<area shape="rect"  title=" " alt="" coords="261,229,339,256"/>
<area shape="rect"  href="_communication_configuration_8h.html" title="file that contains the default communication configuration" alt="" coords="550,80,749,107"/>
<area shape="rect"  title=" " alt="" coords="773,80,883,107"/>
<area shape="rect"  href="_network_8h.html" title="The Network class establishes a WLAN&#45;Connection." alt="" coords="568,155,699,181"/>
<area shape="rect"  href="my_j_s_o_n_8h.html" title="myJSON class handels the conversion from the JSON&#45;Format into a struct" alt="" coords="115,155,256,181"/>
<area shape="rect"  href="my_m_q_t_t_8h.html" title="This class handels the MQTT connection." alt="" coords="331,80,474,107"/>
<area shape="rect"  title=" " alt="" coords="363,229,493,256"/>
<area shape="rect"  title=" " alt="" coords="561,229,615,256"/>
<area shape="rect"  title=" " alt="" coords="639,229,721,256"/>
<area shape="rect"  href="my_j_s_o_n_str_8h.html" title="myJSON Struct defines the format of the messages" alt="" coords="134,229,237,256"/>
<area shape="rect"  title=" " alt="" coords="5,229,109,256"/>
<area shape="rect"  title=" " alt="" coords="432,155,544,181"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="_m_q_t_t_communication_8h__dep__incl.png" border="0" usemap="#_m_q_t_t_communication_8hdep" alt=""/></div>
<map name="_m_q_t_t_communication_8hdep" id="_m_q_t_t_communication_8hdep">
<area shape="rect"  title="The Connection&#45;class is used as interface." alt="" coords="12,5,171,32"/>
<area shape="rect"  href="_m_q_t_t_communication_8cpp.html" title="Implementation of the Connection class." alt="" coords="5,80,177,107"/>
</map>
</div>
</div>
<p><a href="_m_q_t_t_communication_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_communication.html">Communication</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The Connection-class provides the interface.  <a href="class_communication.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac3a129f66dc859e2b7279565f4e1de78"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_m_q_t_t_communication_8h.html#ac3a129f66dc859e2b7279565f4e1de78">callback</a> (char *topic, byte *payload, unsigned int length)</td></tr>
<tr class="memdesc:ac3a129f66dc859e2b7279565f4e1de78"><td class="mdescLeft">&#160;</td><td class="mdescRight">If the client is used to subscribe to topics, a callback function must be provided in the constructor. his function is called when new messages arrive at the client.  <a href="#ac3a129f66dc859e2b7279565f4e1de78">More...</a><br /></td></tr>
<tr class="separator:ac3a129f66dc859e2b7279565f4e1de78"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a7b53ade1cc8486457ead86c3c41a0c7e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classmy_j_s_o_n.html">myJSON</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_m_q_t_t_communication_8h.html#a7b53ade1cc8486457ead86c3c41a0c7e">_myjson</a></td></tr>
<tr class="memdesc:a7b53ade1cc8486457ead86c3c41a0c7e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Declare a global variable from typ <a class="el" href="classmy_j_s_o_n.html" title="myJSON class handels the conversion from the JSON-Format into a struct">myJSON</a> so it can be accessed in callback.  <a href="#a7b53ade1cc8486457ead86c3c41a0c7e">More...</a><br /></td></tr>
<tr class="separator:a7b53ade1cc8486457ead86c3c41a0c7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac88e2994c014e5e95aa2497a7501ea6a"><td class="memItemLeft" align="right" valign="top">CircularBuffer&lt; <a class="el" href="structmy_j_s_o_n_str.html">myJSONStr</a>, <a class="el" href="_communication_configuration_8h.html#acf4afb55aa7d1288ad9dffc623360a8c">MAX_JSON_MESSAGES_SAVED</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_m_q_t_t_communication_8h.html#ac88e2994c014e5e95aa2497a7501ea6a">_buffer</a></td></tr>
<tr class="memdesc:ac88e2994c014e5e95aa2497a7501ea6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Declares a global Circular Buffer of type <a class="el" href="structmy_j_s_o_n_str.html" title="myJSON Struct defines the format of the messages">myJSONStr</a> with max Elements of MAX_JSON_MESSAGES_SAVED.  <a href="#ac88e2994c014e5e95aa2497a7501ea6a">More...</a><br /></td></tr>
<tr class="separator:ac88e2994c014e5e95aa2497a7501ea6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The Connection-class is used as interface. </p>
<dl class="section author"><dt>Author</dt><dd>Luca Mazzoleni (<a href="#" onclick="location.href='mai'+'lto:'+'luc'+'a.'+'maz'+'zo'+'len'+'i@'+'hsr'+'.c'+'h'; return false;">luca.<span style="display: none;">.nosp@m.</span>mazz<span style="display: none;">.nosp@m.</span>oleni<span style="display: none;">.nosp@m.</span>@hsr<span style="display: none;">.nosp@m.</span>.ch</a>)</dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0 - added Connection-Implementation - Luca Mazzoleni (<a href="#" onclick="location.href='mai'+'lto:'+'luc'+'a.'+'maz'+'zo'+'len'+'i@'+'hsr'+'.c'+'h'; return false;">luca.<span style="display: none;">.nosp@m.</span>mazz<span style="display: none;">.nosp@m.</span>oleni<span style="display: none;">.nosp@m.</span>@hsr<span style="display: none;">.nosp@m.</span>.ch</a>) - 2019-04-16</dd></dl>
<dl class="section date"><dt>Date</dt><dd>2019-04-09 </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright (c) 2019</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000003">Todo:</a></b></dt><dd>Split the Code into two Repos: SmartFactory_Communication-Sortic<br />
and SmartFactory_MQTTCommunication-Basis to simplify modular use.</dd></dl>

<p class="definition">Definition in file <a class="el" href="_m_q_t_t_communication_8h_source.html">MQTTCommunication.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ac3a129f66dc859e2b7279565f4e1de78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3a129f66dc859e2b7279565f4e1de78">&#9670;&nbsp;</a></span>callback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void callback </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>topic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *&#160;</td>
          <td class="paramname"><em>payload</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>If the client is used to subscribe to topics, a callback function must be provided in the constructor. his function is called when new messages arrive at the client. </p>
<p>Internally, the client uses the same buffer for both inbound and outbound messages. After the callback function returns, or if a call to either publish or subscribe is made from within the callback function, the topic and payload values passed to the function will be overwritten. The application should create its own copy of the values if they are required beyond this.</p>
<p><a href="https://pubsubclient.knolleary.net/api.html#callback">https://pubsubclient.knolleary.net/api.html#callback</a></p>
<p>This Function is global because you need to access it from a diffrent class and pass it as pointer. This would be possible if it's static but then all function which get called in callback need to be static too.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">topic</td><td>- the topic the message arrived on (const char[]) </td></tr>
    <tr><td class="paramname">payload</td><td>- the message payload (byte array) </td></tr>
    <tr><td class="paramname">length</td><td>- the length of the message payload (unsigned int)</td></tr>
  </table>
  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000002">Todo:</a></b></dt><dd>Change global implementation of callback. Maybe with static? </dd></dl>

<p class="definition">Definition at line <a class="el" href="_m_q_t_t_communication_8cpp_source.html#l00032">32</a> of file <a class="el" href="_m_q_t_t_communication_8cpp_source.html">MQTTCommunication.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ac88e2994c014e5e95aa2497a7501ea6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac88e2994c014e5e95aa2497a7501ea6a">&#9670;&nbsp;</a></span>_buffer</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CircularBuffer&lt;<a class="el" href="structmy_j_s_o_n_str.html">myJSONStr</a>, <a class="el" href="_communication_configuration_8h.html#acf4afb55aa7d1288ad9dffc623360a8c">MAX_JSON_MESSAGES_SAVED</a>&gt; _buffer</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Declares a global Circular Buffer of type <a class="el" href="structmy_j_s_o_n_str.html" title="myJSON Struct defines the format of the messages">myJSONStr</a> with max Elements of MAX_JSON_MESSAGES_SAVED. </p>
<p>When declaring your buffer you should specify the data type it must handle and the buffer capacity: those two parameters will influence the memory consumed by the buffer. <a href="https://github.com/rlogiacco/CircularBuffer">https://github.com/rlogiacco/CircularBuffer</a></p>
<p>Declares a global Circular Buffer of type <a class="el" href="structmy_j_s_o_n_str.html" title="myJSON Struct defines the format of the messages">myJSONStr</a> with max Elements of MAX_JSON_MESSAGES_SAVED. </p>

<p class="definition">Definition at line <a class="el" href="_m_q_t_t_communication_8cpp_source.html#l00026">26</a> of file <a class="el" href="_m_q_t_t_communication_8cpp_source.html">MQTTCommunication.cpp</a>.</p>

</div>
</div>
<a id="a7b53ade1cc8486457ead86c3c41a0c7e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b53ade1cc8486457ead86c3c41a0c7e">&#9670;&nbsp;</a></span>_myjson</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classmy_j_s_o_n.html">myJSON</a> _myjson</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Declare a global variable from typ <a class="el" href="classmy_j_s_o_n.html" title="myJSON class handels the conversion from the JSON-Format into a struct">myJSON</a> so it can be accessed in callback. </p>
<p>Declare a global variable from typ <a class="el" href="classmy_j_s_o_n.html" title="myJSON class handels the conversion from the JSON-Format into a struct">myJSON</a> so it can be accessed in callback. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="_m_q_t_t_communication_8h.html">MQTTCommunication.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>
